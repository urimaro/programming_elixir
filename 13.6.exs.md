ライブラリの探し方

1. Elixirの組み込みライブラリ  
    Elixirのドキュメント  
    http://elixir-lang.org/docs/

2. Erlangの標準ライブラリ  
    以下のサイトの「Application Groups」  
    http://erlang.org/doc/

# 外部ライブラリを探す

3. hexでパッケージを探す  
    hex:  
    Elixirのパッケージマネージャ  
    http://hex.pm

    FYI
    - RubyGems: Ruby
    - pip: Python
    - npm: Node.js

4. Google、GitHubで探す

今回は hex.pm にある「HTTPoison」を使う

# ライブラリをプロジェクトに追加する
以下のファイルを編集してライブラリを管理する
プロジェクトのルートディレクトリ/mix.exs

バージョンの指定の仕方はiexで確認できる

```
> h Version
```

Hexのインストール
`mix deps` 実行時に `Hex` のインストールを求められた

```
goh@goh% mix deps
Could not find Hex, which is needed to build dependency :httpoison
Shall I install Hex? (if running non-interactively, use "mix local.hex --force") [Yn] Y
* creating /Users/goh/.mix/archives/hex-0.17.7
* httpoison (Hex package)
  the dependency is not available, run "mix deps.get"
```

依存関係の確認

```
$ mix deps
```

```
goh@goh% mix deps
* httpoison (Hex package)
  the dependency is not available, run "mix deps.get"
```

ライブラリのインストール
依存関係を解決した上で必要なライブラリをインストールする

```
$ mix deps.get
```

```
goh@goh% mix deps.get
Resolving Hex dependencies...
Dependency resolution completed:
New:
  certifi 2.3.1
  hackney 1.12.1
  httpoison 1.1.1
  idna 5.1.1
  metrics 1.0.1
  mimerl 1.0.2
  parse_trans 3.2.0
  ssl_verify_fun 0.1.1
  unicode_util_compat 0.3.1
* Getting httpoison (Hex package)
* Getting hackney (Hex package)
* Getting certifi (Hex package)
* Getting idna (Hex package)
* Getting metrics (Hex package)
* Getting mimerl (Hex package)
* Getting ssl_verify_fun (Hex package)
* Getting unicode_util_compat (Hex package)
* Getting parse_trans (Hex package)
```

インストール後の確認
`the dependency build is outdated, please run "mix deps.compile"`
インストールされているが、まだコンパイルされていない
ライブラリは `deps` ディレクトリに格納される

```
goh@goh% mix deps
* parse_trans (Hex package) (rebar3)
  locked at 3.2.0 (parse_trans) 2adfa4da
  the dependency build is outdated, please run "mix deps.compile"
* mimerl (Hex package) (rebar3)
  locked at 1.0.2 (mimerl) 993f9b0e
  the dependency build is outdated, please run "mix deps.compile"
* metrics (Hex package) (rebar3)
  locked at 1.0.1 (metrics) 25f094de
  the dependency build is outdated, please run "mix deps.compile"
* unicode_util_compat (Hex package) (rebar3)
  locked at 0.3.1 (unicode_util_compat) a1f612a7
  the dependency build is outdated, please run "mix deps.compile"
* idna (Hex package) (rebar3)
  locked at 5.1.1 (idna) cbc3b2fa
  the dependency build is outdated, please run "mix deps.compile"
* ssl_verify_fun (Hex package) (rebar)
  locked at 1.1.1 (ssl_verify_fun) 28a4d65b
  the dependency build is outdated, please run "mix deps.compile"
* certifi (Hex package) (rebar3)
  locked at 2.3.1 (certifi) d0f42423
  the dependency build is outdated, please run "mix deps.compile"
* hackney (Hex package) (rebar3)
  locked at 1.12.1 (hackney) 8bf2d0e1
  the dependency build is outdated, please run "mix deps.compile"
* httpoison (Hex package) (mix)
  locked at 1.1.1 (httpoison) 96ed7ab7
  the dependency build is outdated, please run "mix deps.compile"
```

# 変換に戻る
`lib/issues/github_issues.ex` に `Issues.GithubIssues.fetch` を実装

`HTTPoison.start` を呼び出すのではなく、OTPを使ってHTTPoisonを実行しておき、Issuesアプリケーションから `HTTPoison.get` を呼び出す
どのアプリケーションを起動するかは `mix.exs` で指定する

OTP:
実行しているアプリケーションを管理するフレームワーク
詳しくは第Ⅱ部参照

iexでアプリケーションを実行する
初回はコンパイルされている

```
$ iex -S mix
```

```
goh@goh% iex -S mix
Erlang/OTP 20 [erts-9.3.1] [source] [64-bit] [smp:4:4] [ds:4:4:10] [async-threads:10] [hipe] [kernel-poll:false] [dtrace]

Could not find "rebar3", which is needed to build dependency :parse_trans
I can install a local copy which is just used by Mix
Shall I install rebar3? (if running non-interactively, use "mix local.rebar --force") [Yn] Y
* creating /Users/goh/.mix/rebar
* creating /Users/goh/.mix/rebar3
===> Compiling parse_trans
===> Compiling mimerl
===> Compiling metrics
===> Compiling unicode_util_compat
===> Package unicode_util_compat-0.3.1 not found. Fetching registry updates and trying again...
===> Updating package registry...
===> Writing registry to /Users/goh/.cache/rebar3/hex/default/registry
===> Generating package index...
===> [appsignal:1.6.2], Bad dependency version for httpoison: ~> 0.11 or ~> 1.0.
===> [appsignal:1.6.0], Bad dependency version for httpoison: ~> 0.11 or ~> 1.0.
===> [appsignal:1.6.0-beta.1], Bad dependency version for httpoison: ~> 0.11 or ~> 1.0.
===> [appsignal:1.6.3], Bad dependency version for httpoison: ~> 0.11 or ~> 1.0.
===> [appsignal:1.6.1], Bad dependency version for httpoison: ~> 0.11 or ~> 1.0.
===> [appsignal:1.6.0-alpha.1], Bad dependency version for httpoison: ~> 0.11 or ~> 1.0.
===> Writing index to /Users/goh/.cache/rebar3/hex/default/packages.idx
===> Compiling idna
==> ssl_verify_fun (compile)
Compiled src/ssl_verify_util.erl
Compiled src/ssl_verify_fingerprint.erl
Compiled src/ssl_verify_pk.erl
Compiled src/ssl_verify_hostname.erl
===> Compiling certifi
===> Compiling hackney
==> httpoison
Compiling 2 files (.ex)
Generated httpoison app
==> issues
Compiling 3 files (.ex)
warning: variable "count" is unused
  lib/issues/cli.ex:44

Generated issues app
Interactive Elixir (1.6.5) - press Ctrl+C to exit (type h() ENTER for help)
```

